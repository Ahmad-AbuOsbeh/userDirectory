<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<script src="../../../../scripts/buildfire.min.js"></script>
		<link href="../../../../styles/helper.css" rel="stylesheet" />
		<link href="../../../../styles/siteIcons.css" rel="stylesheet" />
		<link rel="stylesheet" href="../assets/base.css">
		<style>
			.subTitle {
				margin-bottom: 25px;
				font-style: italic;
			}

			textarea:invalid,
			input:invalid {
				background-color: lightpink;
			}

			.hidden {
				display: none;
			}

			#deleteButton {
				padding-right: 25px;
				margin-top: 5px;
			}
		</style>

		<!--
        Add more string here
        ../../widget/js/shared/stringsConfig.js  <=========================== README
        this file is shared with the widget.
    -->

		<!-- build:bundleSharedJSFiles  -->
		<script src="../../widget/js/shared/stringsConfig.js"></script>
		<script src="../../widget/js/shared/strings.js"></script>
		<!-- endbuild -->

		<!-- build:bundleJSFiles  -->
		<script src="js/stringsUI.js"></script>
		<!-- endbuild -->

		<script src="../../../../scripts/tinymce/tinymce.min.js"></script>
	</head>
	<body>
		<a id="createButton" class="text-success hidden" onclick="createLanguage(langOptions.value)">Click here to begin supporting this language</a>

		<div id="stringsContainer" class="hidden">
			loading...
		</div>
		<a id="saveButton" class="btn btn-success pull-right hidden" onclick="save()">Save</a>
		<a id="deleteButton" class="text-danger pull-right hidden" onclick="deleteLanguage(strings.id)">Delete</a>

		<div class="test">
			<h1 class="section__title">Join Dialog</h1>
			<p class="info margin-bottom-thirty">Only users  that confirm this prompt will be added to the user directory</p>
			<div class="input-row">
				<label class="label-container">Title</label>
				<input class="input-container" type="text" value="User Directory">
			</div>
			<div class="input-row">
				<label class="label-container">Message</label>
				<input class="input-container" type="text" value="Do you wish to be added to the User Directory?">
			</div>
			<div class="input-row">
				<label class="label-container">Cancel Button</label>
				<div class="input-container">
					<input class="input-container" type="text" value="No">
					<label class="margin-right-fifteen margin-left-fifteen">Confirm Button</label>
					<input class="input-container" type="text" value="Join">
				</div>
			</div>

			<h1 class="section__title">Leave Dialog</h1>
			<div class="input-row">
				<label class="label-container">Title</label>
				<input class="input-container" type="text" value="User Directory">
			</div>
			<div class="input-row">
				<label class="label-container">Message</label>
				<input class="input-container" type="text" value="Do you wish to leave the User Directory?">
			</div>
			<div class="input-row">
				<label class="label-container">Cancel Button</label>
				<div class="input-container">
					<input class="input-container" type="text" value="Cancel">
					<label class="margin-right-fifteen margin-left-fifteen">Confirm Button</label>
					<input class="input-container" type="text" value="Leave">
				</div>
			</div>

			<h1 class="section__title">Information Messages</h1>
			<div class="input-row">
				<label class="label-container">Added to Favorites</label>
				<input class="input-container" type="text" value="Added to Favorites">
			</div>
			<div class="input-row">
				<label class="label-container">Removed from Favorites</label>
				<input class="input-container" type="text" value="Removed from Favorites">
			</div>
			
			<h1 class="section__title">Other</h1>
			<div class="input-row">
				<label class="label-container">Message User</label>
				<input class="input-container" type="text" value="Message User">
			</div>
			<div class="input-row">
				<label class="label-container">Add to Favorites</label>
				<input class="input-container" type="text" value="Add to Favorites">
			</div>
			<div class="input-row">
				<label class="label-container">Remove from Favorites</label>
				<input class="input-container" type="text" value="Remove from Favorites">
			</div>
			<div class="input-row">
				<label class="label-container">Report User</label>
				<input class="input-container" type="text" value="Report User">
			</div>
			<div class="input-row">
				<label class="label-container">Leave User Directory</label>
				<input class="input-container" type="text" value="Leave User Directory">
			</div>
			<div class="input-row">
				<label class="label-container">Search</label>
				<input class="input-container" type="text" value="Search">
			</div>
			<div class="input-row">
				<label class="label-container">Favorites</label>
				<input class="input-container" type="text" value="Favorites">
			</div>

		</div>

		<script>
			let strings;

			function loadLanguage(lang) {
				stringsContainer.classList.add('hidden');
				strings = new buildfire.services.Strings(lang, stringsConfig);
				strings.init().then(() => {
					showNewLanguageState(strings.id);
					strings.inject();
				});
				stringsUI.init('stringsContainer', strings, stringsConfig);
			}
			loadLanguage('en-us');

			function showNewLanguageState(show) {
				if (show) {
					deleteButton.classList.remove('hidden');
					saveButton.classList.remove('hidden');
					stringsContainer.classList.remove('hidden');
					createButton.classList.add('hidden');
				} else {
					deleteButton.classList.add('hidden');
					saveButton.classList.add('hidden');
					stringsContainer.classList.add('hidden');
					createButton.classList.remove('hidden');
				}
			}

			function createLanguage(language) {
				stringsContainer.disabled = true;
				strings.createLanguage(language, () => {
					stringsContainer.disabled = false;
				});
				showNewLanguageState(true);
				return false;
			}

			function deleteLanguage() {
				buildfire.notifications.confirm({ message: 'Are you sure you want to remove support fo this language?', confirmButton: { type: 'danger' } }, (e, r) => {
					if (r.selectedButton.key == 'confirm') {
						strings.deleteLanguage(() => {
							loadLanguage(langOptions.value);
						});
					}
				});
			}

			function save() {
				strings.save(() => {
					buildfire.messaging.sendMessageToWidget({ cmd: 'refresh' });
				});
			}
		</script>
	</body>
</html>
